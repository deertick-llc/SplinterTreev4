Improve database connection and schema handling

- Ensure databases directory exists
- Modify schema application to handle multiple statements
- Maintain robust error handling
- Preserve existing database functionality

Resolves database connection and schema application issues
